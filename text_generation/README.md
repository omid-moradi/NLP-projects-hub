# ๐ง Persian Poetry Generation with TensorFlow

This project builds a character-level text generation model using TensorFlow to generate classical Persian poetry. The model learns stylistic and linguistic patterns from the poems of **Nasir Khusraw** and **Attar**, and generates new verses in a similar poetic style.

---

## ๐ Dataset
- Two plain text files containing Persian poems:
  - `khosrow.txt` โ verses by ูุงุตุฑ ุฎุณุฑู
  - `attar.txt` โ verses by ุนุทุงุฑ ูุดุงุจูุฑ
- Texts are preprocessed and merged for model training.

---

## ๐งน Preprocessing

- **Text normalization**: Including removal of extra whitespace and standardization of characters.
- **Character-level tokenization** using `StringLookup` from TensorFlow.
- **Vocabulary creation**: Mapped characters to integers and vice versa.
- **Sliding window**:
  - Input sequences of fixed length are extracted from the poems.
  - Each sequence is paired with its next character for prediction.

---

## ๐๏ธ Model Architecture

Implemented using `tf.keras.Sequential` with the following layers:

- `Embedding`: Converts characters to dense vectors
- `LSTM`: Learns temporal patterns in sequences
- `Dense`: Predicts the next character in the sequence

---

## ๐๏ธ Training

- **Loss function**: `sparse_categorical_crossentropy`
- **Optimizer**: `Adam`
- Training is done over shuffled batches using:
  - A sliding window generator
  - Epochs configurable in the notebook
- Model checkpoints may be used for recovery and continuation.

---

## โจ Poetry Generation

- Generation begins from a Persian **seed phrase** (e.g., "ุง ุฏู").
- **Temperature sampling** controls creativity:
  - Low temperature: More grammatical and repetitive
  - High temperature: More surprising and creative
- Generated one character at a time and looped until desired length.

---

## ๐พ Output Files

| File                  | Description                             |
|-----------------------|-----------------------------------------|
| `text_generation.ipynb` | Main notebook for training and generation |
| `char2idx.json`       | Character to index mapping              |
| `idx2char.json`       | Index to character mapping              |
| `generated_poems.txt` | Output poetry generated by the model    |

---

## โ Requirements

- Python 3.8+
- TensorFlow 2.x
- NumPy
- Google Colab or Jupyter Notebook

---

## ๐ Example Result

> Seed: "ุง ุฏู"  
> Generated Output:  
> "ุง ุฏู ุจู ุฌูุงู ุงฺฏุฑ ุจุฏุงู / ุงูุฏุฑ ุบู ู ุดุงุฏ ููุงู / ุดุจ ุฑุง ุจู ุฏุนุง ฺฉู ุณุญุฑ ฺฉู / ุจุฑ ููุฑ ุญููุช ูุดุงู"

---

Made with โค๏ธ to revive classical Persian poetry through modern AI.
