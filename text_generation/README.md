# 🧠 Persian Poetry Generation with TensorFlow

This project builds a character-level text generation model using TensorFlow to generate classical Persian poetry. The model learns stylistic and linguistic patterns from the poems of **Nasir Khusraw** and **Attar**, and generates new verses in a similar poetic style.

---

## 📁 Dataset
- Two plain text files containing Persian poems:
  - `khosrow.txt` – verses by ناصر خسرو
  - `attar.txt` – verses by عطار نیشابوری
- Texts are preprocessed and merged for model training.

---

## 🧹 Preprocessing

- **Text normalization**: Including removal of extra whitespace and standardization of characters.
- **Character-level tokenization** using `StringLookup` from TensorFlow.
- **Vocabulary creation**: Mapped characters to integers and vice versa.
- **Sliding window**:
  - Input sequences of fixed length are extracted from the poems.
  - Each sequence is paired with its next character for prediction.

---

## 🏗️ Model Architecture

Implemented using `tf.keras.Sequential` with the following layers:

- `Embedding`: Converts characters to dense vectors
- `LSTM`: Learns temporal patterns in sequences
- `Dense`: Predicts the next character in the sequence

---

## 🏋️ Training

- **Loss function**: `sparse_categorical_crossentropy`
- **Optimizer**: `Adam`
- Training is done over shuffled batches using:
  - A sliding window generator
  - Epochs configurable in the notebook
- Model checkpoints may be used for recovery and continuation.

---

## ✨ Poetry Generation

- Generation begins from a Persian **seed phrase** (e.g., "ای دل").
- **Temperature sampling** controls creativity:
  - Low temperature: More grammatical and repetitive
  - High temperature: More surprising and creative
- Generated one character at a time and looped until desired length.

---

## 💾 Output Files

| File                  | Description                             |
|-----------------------|-----------------------------------------|
| `text_generation.ipynb` | Main notebook for training and generation |
| `char2idx.json`       | Character to index mapping              |
| `idx2char.json`       | Index to character mapping              |
| `generated_poems.txt` | Output poetry generated by the model    |

---

## ✅ Requirements

- Python 3.8+
- TensorFlow 2.x
- NumPy
- Google Colab or Jupyter Notebook

---

## 📌 Example Result

> Seed: "ای دل"  
> Generated Output:  
> "ای دل به جهان اگر بدانی / اندر غم و شادی نهانی / شب را به دعا کنی سحر کن / بر نور حقیقتی نشانی"

---

Made with ❤️ to revive classical Persian poetry through modern AI.
